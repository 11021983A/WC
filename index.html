<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞—è–≤–∫–∞ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</title>
    <style>
        /* –ü—Ä–æ—Å—Ç—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ */
        body {
            font-family: Arial, sans-serif;
            max-width: 400px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }

        .room-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .problem-list {
            margin: 20px 0;
        }

        .problem-item {
            margin: 10px 0;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .problem-item:hover {
            border-color: #2196F3;
            background-color: #f8f9ff;
        }

        .problem-item.selected {
            border-color: #2196F3;
            background-color: #e3f2fd;
        }

        .problem-item input {
            margin-right: 10px;
        }

        .custom-text {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            display: none;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }

        .submit-btn:hover {
            background: #1976D2;
        }

        .message {
            display: none;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            text-align: center;
        }

        .success {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .error {
            background: #ffcdd2;
            color: #c62828;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß –ó–∞—è–≤–∫–∞ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h1>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–º–µ—â–µ–Ω–∏–∏ -->
        <div class="room-info" id="roomInfo">
            –ü–æ–º–µ—â–µ–Ω–∏–µ: –ö–æ—Ä–ø—É—Å FFFA, 2 —ç—Ç–∞–∂, –¢—É–∞–ª–µ—Ç ‚Ññ001
        </div>

        <form id="requestForm">
            <div class="problem-list">
                <div class="problem-item" onclick="selectProblem(this, 'soap')">
                    <input type="radio" name="problem" value="soap" id="soap">
                    <label for="soap">üßº –ó–∞–∫–æ–Ω—á–∏–ª–æ—Å—å –º—ã–ª–æ</label>
                </div>

                <div class="problem-item" onclick="selectProblem(this, 'paper')">
                    <input type="radio" name="problem" value="paper" id="paper">
                    <label for="paper">üßª –ó–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –±—É–º–∞–∂–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏</label>
                </div>

                <div class="problem-item" onclick="selectProblem(this, 'trash')">
                    <input type="radio" name="problem" value="trash" id="trash">
                    <label for="trash">üóëÔ∏è –í—ã–Ω–µ—Å—Ç–∏ –º—É—Å–æ—Ä</label>
                </div>

                <div class="problem-item" onclick="selectProblem(this, 'cleaning')">
                    <input type="radio" name="problem" value="cleaning" id="cleaning">
                    <label for="cleaning">üßΩ –ü—Ä–∏–±—Ä–∞—Ç—å—Å—è</label>
                </div>

                <div class="problem-item" onclick="selectProblem(this, 'other')">
                    <input type="radio" name="problem" value="other" id="other">
                    <label for="other">üìù –î—Ä—É–≥–∞—è –ø—Ä–æ–±–ª–µ–º–∞</label>
                </div>

                <!-- –ü–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Å–≤–æ–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ -->
                <textarea 
                    id="customText" 
                    class="custom-text" 
                    placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É..."
                    rows="3"
                ></textarea>
            </div>

            <button type="submit" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        </form>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        <div id="successMessage" class="message success">
            ‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ò–Ω–∂–µ–Ω–µ—Ä—ã –ø–æ–ª—É—á–∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.
        </div>

        <div id="errorMessage" class="message error">
            ‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.
        </div>
    </div>

    <script>
        // ============ –ü–†–û–°–¢–ê–Ø –õ–û–ì–ò–ö–ê ============

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏—è
        let roomData = {
            building: '–°–í–í',
            floor: '02', 
            type: 'WC',
            number: '001',
            name: '–¢—É–∞–ª–µ—Ç'
        };

        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ß–∏—Ç–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL (–ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º QR-–∫–æ–¥—ã)
            loadRoomFromURL();
            updateRoomDisplay();
        });

        /**
         * –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–º–µ—â–µ–Ω–∏—è –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
         * –ü—Ä–∏–º–µ—Ä URL: index.html?building=A&floor=02&type=WC&number=001
         */
        function loadRoomFromURL() {
            const params = new URLSearchParams(window.location.search);
            
            // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
            if (params.get('building')) {
                roomData.building = params.get('building');
            }
            if (params.get('floor')) {
                roomData.floor = params.get('floor');
            }
            if (params.get('type')) {
                roomData.type = params.get('type');
            }
            if (params.get('number')) {
                roomData.number = params.get('number');
            }

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–º–µ—â–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É
            const roomNames = {
                'WC': '–¢—É–∞–ª–µ—Ç',
                'KITCHEN': '–ö—É—Ö–Ω—è',
                'OFFICE': '–û—Ñ–∏—Å',
                'MEETING': '–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è',
                'STORAGE': '–°–∫–ª–∞–¥'
            };
            
            roomData.name = roomNames[roomData.type] || '–ü–æ–º–µ—â–µ–Ω–∏–µ';
        }

        /**
         * –û–±–Ω–æ–≤–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–º–µ—â–µ–Ω–∏–∏
         */
        function updateRoomDisplay() {
            const roomInfo = document.getElementById('roomInfo');
            roomInfo.textContent = `${roomData.name}: –ö–æ—Ä–ø—É—Å ${roomData.building}, ${roomData.floor} —ç—Ç–∞–∂, ‚Ññ${roomData.number}`;
        }

        /**
         * –í—ã–±–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã
         */
        function selectProblem(element, problemType) {
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.problem-item').forEach(item => {
                item.classList.remove('selected');
            });

            // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
            element.classList.add('selected');

            // –û—Ç–º–µ—á–∞–µ–º —Ä–∞–¥–∏–æ-–∫–Ω–æ–ø–∫—É
            const radio = element.querySelector('input');
            radio.checked = true;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –¥–ª—è —Ç–µ–∫—Å—Ç–∞, –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ "–î—Ä—É–≥–∞—è –ø—Ä–æ–±–ª–µ–º–∞"
            const customText = document.getElementById('customText');
            if (problemType === 'other') {
                customText.style.display = 'block';
                customText.focus();
            } else {
                customText.style.display = 'none';
                customText.value = '';
            }
        }

        /**
         * –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
         */
        document.getElementById('requestForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞
            const selectedProblem = document.querySelector('input[name="problem"]:checked');
            if (!selectedProblem) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É');
                return;
            }

            // –ü–æ–ª—É—á–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
            let problemDescription = '';
            if (selectedProblem.value === 'other') {
                const customText = document.getElementById('customText').value.trim();
                if (!customText) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É');
                    return;
                }
                problemDescription = '–î—Ä—É–≥–∞—è –ø—Ä–æ–±–ª–µ–º–∞: ' + customText;
            } else {
                // –ë–µ—Ä–µ–º —Ç–µ–∫—Å—Ç –∏–∑ label
                const problemLabels = {
                    'soap': '–ó–∞–∫–æ–Ω—á–∏–ª–æ—Å—å –º—ã–ª–æ',
                    'paper': '–ó–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –±—É–º–∞–∂–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏',
                    'trash': '–í—ã–Ω–µ—Å—Ç–∏ –º—É—Å–æ—Ä',
                    'cleaning': '–ü—Ä–∏–±—Ä–∞—Ç—å—Å—è'
                };
                problemDescription = problemLabels[selectedProblem.value];
            }

            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏
            const requestData = {
                // –î–∞–Ω–Ω—ã–µ –ø–æ–º–µ—â–µ–Ω–∏—è
                roomId: `${roomData.building}-${roomData.floor}-${roomData.type}-${roomData.number}`,
                building: roomData.building,
                floor: roomData.floor,
                roomType: roomData.type,
                roomNumber: roomData.number,
                roomName: roomData.name,

                // –î–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
                problemType: selectedProblem.value,
                problemDescription: problemDescription,

                // –í—Ä–µ–º—è
                date: new Date().toLocaleDateString('ru-RU'),
                time: new Date().toLocaleTimeString('ru-RU'),
                timestamp: new Date().toISOString()
            };

            // –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å–æ–ª–∏
            console.log('–î–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏:', requestData);
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É
            sendRequest(requestData);
        });

        /**
         * –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏ (–ø–æ–∫–∞ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ backend)
         */
        function sendRequest(data) {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
            const submitBtn = document.querySelector('.submit-btn');
            submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–ª—è–µ–º...';
            submitBtn.disabled = true;

            // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É —Å–µ—Ç–∏
            setTimeout(function() {
                // –í 90% —Å–ª—É—á–∞–µ–≤ "—É—Å–ø–µ—Ö"
                if (Math.random() > 0.1) {
                    showSuccess();
                } else {
                    showError();
                }

                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                submitBtn.textContent = '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É';
                submitBtn.disabled = false;
            }, 1500);
        }

        /**
         * –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
         */
        function showSuccess() {
            const successMsg = document.getElementById('successMessage');
            const errorMsg = document.getElementById('errorMessage');
            
            successMsg.style.display = 'block';
            errorMsg.style.display = 'none';

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(function() {
                resetForm();
                successMsg.style.display = 'none';
            }, 3000);
        }

        /**
         * –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
         */
        function showError() {
            const successMsg = document.getElementById('successMessage');
            const errorMsg = document.getElementById('errorMessage');
            
            errorMsg.style.display = 'block';
            successMsg.style.display = 'none';

            // –°–∫—Ä—ã–≤–∞–µ–º –æ—à–∏–±–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(function() {
                errorMsg.style.display = 'none';
            }, 3000);
        }

        /**
         * –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
         */
        function resetForm() {
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
            document.querySelectorAll('.problem-item').forEach(item => {
                item.classList.remove('selected');
            });

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–∞–¥–∏–æ-–∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('input[name="problem"]').forEach(radio => {
                radio.checked = false;
            });

            // –°–∫—Ä—ã–≤–∞–µ–º –∏ –æ—á–∏—â–∞–µ–º –ø–æ–ª–µ –¥–ª—è —Ç–µ–∫—Å—Ç–∞
            const customText = document.getElementById('customText');
            customText.style.display = 'none';
            customText.value = '';
        }

        // ============ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï ============
        
        /**
         * –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π
         * –í—ã–∑–æ–≤–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞: testRoom('B', '03', 'KITCHEN', '001')
         */
        function testRoom(building, floor, type, number) {
            roomData.building = building;
            roomData.floor = floor;
            roomData.type = type;
            roomData.number = number;
            
            const roomNames = {
                'WC': '–¢—É–∞–ª–µ—Ç',
                'KITCHEN': '–ö—É—Ö–Ω—è', 
                'OFFICE': '–û—Ñ–∏—Å',
                'MEETING': '–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è',
                'STORAGE': '–°–∫–ª–∞–¥'
            };
            
            roomData.name = roomNames[type] || '–ü–æ–º–µ—â–µ–Ω–∏–µ';
            updateRoomDisplay();
            
            console.log('–¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–º–µ—â–µ–Ω–∏–µ:', roomData);
        }
    </script>
</body>
</html>
